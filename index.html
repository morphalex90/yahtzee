<!DOCTYPE html>
<html lang="it">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Yahtzee - the Game</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<style>
			.dado{display:inline-block; height:30px; width:30px; background:red; color:white; text-align:center; padding-top:5px; border-radius: 5px; cursor: pointer;}
			.margin-30{margin-top:30px;}
			.dado.selezionato{background:blue;}
			.combinazione.info{cursor:pointer;}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="row">
				<div class="col-md-6 margin-30">
					<div class="dadi">
						<div id="dado_1" class="dado"></div>
						<div id="dado_2" class="dado"></div>
						<div id="dado_3" class="dado"></div>
						<div id="dado_4" class="dado"></div>
						<div id="dado_5" class="dado"></div>
					</div>
				</div>
				<div class="col-md-6 margin-30">
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<tbody>
								<tr class="combinazione" id="somma_1"><td>Somma degli 1</td><td class="result"></td></tr>
								<tr class="combinazione" id="somma_2"><td>Somma dei 2</td><td class="result"></td></tr>
								<tr class="combinazione" id="somma_3"><td>Somma dei 3</td><td class="result"></td></tr>
								<tr class="combinazione" id="somma_4"><td>Somma dei 4</td><td class="result"></td></tr>
								<tr class="combinazione" id="somma_5"><td>Somma dei 5</td><td class="result"></td></tr>
								<tr class="combinazione" id="somma_6"><td>Somma dei 6</td><td class="result"></td></tr>
								<tr class="combinazione" id="uguali_3"><td>3 dadi uguali</td><td class="result"></td></tr>
								<tr class="combinazione" id="uguali_4"><td>4 dadi uguali</td><td class="result"></td></tr>
								<tr class="combinazione" id="full"><td>Full</td><td class="result"></td></tr>
								<tr class="combinazione" id="scala_4"><td>Scala con 4 dadi</td><td class="result"></td></tr>
								<tr class="combinazione" id="scala_5"><td>Scala con 5 dadi</td><td class="result"></td></tr>
								<tr class="combinazione" id="yahtzee"><td>Yahtzee</td><td class="result"></td></tr>
								<tr class="combinazione" id="somma"><td>Somma</td><td class="result"></td></tr>
							</tbody>
							<tfoot>
								<tr class="combinazione" id="totale"><td>Totale</td><td class="result">0</td></tr>
							</tfoot>
						</table>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12 text-center">
					<button class="btn lancio_dadi">Lancia i dadi</button>
				</div>
			</div>
		</div>

		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<script>
		var tentativi=3;
		var tentativo_attuale=0;
		var numeri = [];
		var count = [];
		jQuery(document).ready(function(){
	
			
			jQuery('.lancio_dadi').click(function(){
				if(tentativo_attuale<(tentativi-1)){
					lancia_dadi();
					tentativo_attuale++;
				}else{
					lancia_dadi();
					jQuery(this).attr('disabled','disabled');
					tentativo_attuale=0;
				}
				controlloPunteggio();
			});
			
			jQuery('.dado').click(function(){ // al click del dado lo tengo, al ri click lo deseleziono e puÃ² cambiare
				if(jQuery(this).hasClass('selezionato'))
					jQuery(this).removeClass('selezionato');
				else
					jQuery(this).addClass('selezionato');
			});
			
			jQuery(document).on('click','.combinazione.info',function(){

				jQuery(this).removeClass('info').addClass('success');
				if(jQuery(this).attr('id')=='somma_1'){
					jQuery(this).find('.result').html(count[1]*1);
					jQuery('.combinazione#totale .result').html(parseInt(jQuery('.combinazione#totale .result').html())+(parseInt(jQuery('#somma_1 .result').html())));
				}
				
				if(jQuery(this).attr('id')=='somma_2'){
					jQuery(this).find('.result').html(count[2]*2);
					jQuery('.combinazione#totale .result').html(parseInt(jQuery('.combinazione#totale .result').html())+(parseInt(jQuery('#somma_2 .result').html())));
				}
				
				if(jQuery(this).attr('id')=='somma_3'){
					jQuery(this).find('.result').html(count[3]*3);
					jQuery('.combinazione#totale .result').html(parseInt(jQuery('.combinazione#totale .result').html())+(parseInt(jQuery('#somma_3 .result').html())));
				}
				
				if(jQuery(this).attr('id')=='somma_4'){
					jQuery(this).find('.result').html(count[4]*4);
					jQuery('.combinazione#totale .result').html(parseInt(jQuery('.combinazione#totale .result').html())+(parseInt(jQuery('#somma_4 .result').html())));
				}
				
				if(jQuery(this).attr('id')=='somma_5'){
					jQuery(this).find('.result').html(count[5]*5);
					jQuery('.combinazione#totale .result').html(parseInt(jQuery('.combinazione#totale .result').html())+(parseInt(jQuery('#somma_5 .result').html())));
				}
				
				if(jQuery(this).attr('id')=='somma_6'){
					jQuery(this).find('.result').html(count[6]*6);
					jQuery('.combinazione#totale .result').html(parseInt(jQuery('.combinazione#totale .result').html())+(parseInt(jQuery('#somma_6 .result').html())));
				}
				
				tentativo_attuale=0;
				jQuery('.lancio_dadi').removeAttr('disabled');
			});
			
		});
		
		function random(){
			return Math.floor((Math.random() * 6) + 1); // random tra 1 e 6, per simulare un dado
		}
		
		function lancia_dadi(){
			numeri = [];
			jQuery('.dado').each(function(){
				if(!jQuery(this).hasClass('selezionato'))
					jQuery(this).text(random());
				numeri.push(jQuery(this).html()); 
			});
		}
		
		function controlloPunteggio(){
		
			count = {'1':0,'2':0,'3':0,'4':0,'5':0,'6':0}; // creo l'array che mi conta i numeri
	
			for(var i = 0; i < numeri.length; ++i){
				count[numeri[i]]++;
			}
			
		
			if(count[1]>1) jQuery('#somma_1').addClass('info'); else jQuery('#somma_1').removeClass('info');
			if(count[2]>1) jQuery('#somma_2').addClass('info'); else jQuery('#somma_2').removeClass('info');
			if(count[3]>1) jQuery('#somma_3').addClass('info'); else jQuery('#somma_3').removeClass('info');
			if(count[4]>1) jQuery('#somma_4').addClass('info'); else jQuery('#somma_4').removeClass('info');
			if(count[5]>1) jQuery('#somma_5').addClass('info'); else jQuery('#somma_5').removeClass('info');
			if(count[6]>1) jQuery('#somma_6').addClass('info'); else jQuery('#somma_6').removeClass('info');

		
		}
		</script>
	</body>
</html>